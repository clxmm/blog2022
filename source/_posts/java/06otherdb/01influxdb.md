---
title: 01动态生成world
toc: true
tags: influxdb
categories: 
    - [db]
    - [influxdb]
---

## 1.第**1**章 认识InfluxDB

### **1.1 InfluxDB** 的使用场景

InfluxDB 是一种时序数据库，时序数据库通常被用在监控场景，比如运维和 IOT(物联网)领域。这类数据库旨在存储时序数据并实时处理它们。

### **1.2** 为什么不用关系型数据库

#### **1.2.1** 写入性能

​		关系型数据库也是支持时间戳的，也能够基于时间戳进行查询。但是，从我们的使用场景出发，需要注意数据库的写入性能。通常，关系型数据库会采用 B+树数据结构，在数据写入时，有可能会触发叶裂变，从而产生了**对磁盘的随机读写，降低写入速度**。

​		当前市面上的时序数据库通常都是采用 LSM Tree 的变种，顺序写磁盘来增强数据的写入能力,常时序数据库 都会保证在单点每秒数十万的写入能力。

<!--more-->

#### **1.2.2** 数据价值

​	我们之前说，时序数据库一般用于指标监控场景。这个场景的数据有一个非常明显的特点就是冷热差别明显。通常，指标监控只会使用近期一段时间的数据，比如我只查询某个设备最近 10 分钟的记录，10 分钟前的数据我就不再用了。那么这 10 分钟前的数据，对我们来说就是冷数据，应该被压缩放到磁盘里去来节省空间。而热数据因为经常要用，数据库就应该让它留在内存里，等待查询。而市面上的时序数据库大都有类似的设计。

#### **1.2.3** 时间不可倒流，数据只写不改

​	时序数据是描述一个实体在不同时间所处的不同状态。

​	就像是我们打开任务管理器，查看 CPU 的使用情况。我发现 CPU 占用率太高了，于是杀死了一个进程，但 10 秒前的数据不会因为我关闭进程再发生改变了。

​	这是时序数据的一大特点。与之相应，时序数据库基本上是插入操作较多，而且还没有什么更新需求。

### **1.3 1.X** 的 **TICK** 技术栈与 **2.X** 的进一步融合

​	根据上文的介绍，我们首先可以知道时序数据一般用在监控场景。大体上，数据的应用可以分为 4 步走。

- (1)数据采集
- (2)存储
- (3)查询(包括聚合操作)
- (4)报警



​	这样一看，只给一个数据库其实只能完成数据的存储和查询功能，上游的采集和下游的报警都需要自己来实现。因此 InfluxData 在 InfluxDB1.X 的时候推出了 TICK 生态来推出start 全套的解决方案。

​	TICK4 个字母分别对应 4 个组件。

- T :Telegraf -数据采集组件，收集&发送数据到InfluxDB。
- I :InfluxDB -存储数据&发送数据到Chronograf。
-  C : Chronograf - 总的用户界面，起到总的管理功能。
-  K : Kapacitor - 后台处理报警信息。

到了 2.x，TICK 进一步融合，ICK 的功能全部融入了 InfluxDB，仅需安装 InfluxDB 就能得到一个管理页面，而且附带了定时任务和报警功能。

### **1.4 influxDB** 版本比较与选型

#### **1.4.1** 版本特性比较

​	2020 年 InfluxDB 推出了 2.0 的正式版。2.x 同 1.x 相比，底层引擎原理相差不大，但会 涉及一些概念的转变(例如 db/rp 换成了 org/bucket)。另外，对于 TICK 生态来说，1.x 需 要自己配置各个组件。2.x 则是更加方便集成，有很棒的管理页面。

​	另外，在查询语言方面，1.x 是使用 InfluxQL 进行查询，它的风格近似 SQL。2.x 推出 了 FLUX 查询语言，可以使用函数与管道符，是一种更符合时序数据特性的更具表现力的 查询语言。

#### **1.4.2** 选型，本文档使用 **InfluxDB 2.4**

- 市场现状:目前企业里面用 InfluxDB 1.X 和 InfluxDB 2.X 都有人在用，数量上 InfluxDB1.X 占多一些。
- 易用性:在开发中，InfluxDB 1.X 集成生态会比较麻烦，InfluxDB 2.X 相对来说更加 便利。
- 性能:InfluxDB 1.X 和 2.X 的内核原理基本一致，性能上差距不大。
-  集群:InfluxDB 从 0.11 版本开始，就闭源了集群功能的代码。也就是说，你只能免费试用 InfluxDB 的单节点版(开源)，想要集群等功能就需要购买企业版。不过就 InfluxDB 1.8 来说，有开源项目根据 0.11 的代码思路提供了 InfluxDB 开源的集群方案。也 有开源项目给 InfluxDB 2.3 增加了反向代理功能，让我们可以横向拓展 InfluxDB 的服务能 力。

- FLUX 语言支持:自 InfluxDB 1.7 和 InfluxDB 2.0 以来，InfluxDB 推出了一门独立的

  新的查询语言 FLUX，而且作为一个独立的项目来运作。InfluxData 公司希望 FLUX 语言能 够成为一个像 SQL 一样的通用标准，而不仅仅是查询 InfluxDB 的特定语言。而且不管是 你是选择 InfluxDB 1.X 还是 2.X 最终都会接触到 FLUX。不过 2.X 对 FLUX 的支持性要更 好一些。

- InfluxDB 产品概况:

  - InfluxDB1.8在小版本上还在更新，主要是修复一些BUG，不再添加新特性
  - nfluxDB2.4这是InfluxDB较新的版本，仍然在增加新的特性。
  - InfluxDB企业版1.9需要购买，相比开源版，它有集群功能
  - InfluxDB Cloud，免部署，跑在 InfluxData 公司的云服务器上，你可以使用客户端来操作。功能上对应开源版的 2.4

- 2.x 与 1.x 的主要区别:两个版本的内核原理基本一致，性能上的差别不大。差别主要是在，权限管理方式不同，2.x TICK 的集成性比 1.x 好，1.x 中的 database 到了 2.x 中变 成了 bucket 等。

## 第**2**章 安装部署 **InfluxDB**



